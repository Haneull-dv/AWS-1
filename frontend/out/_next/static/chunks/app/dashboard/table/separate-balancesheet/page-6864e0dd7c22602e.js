(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{5973:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var l=r(95155),d=r(12115);function a(){let[e,t]=(0,d.useState)(!1),[r,a]=(0,d.useState)(null),[n,s]=(0,d.useState)(null),[o,i]=(0,d.useState)(""),[c,g]=(0,d.useState)(""),[u,x]=(0,d.useState)([]),[b,h]=(0,d.useState)([]),[m,p]=(0,d.useState)(null),f=e=>{if(null==e||""===e)return"";let t="string"==typeof e?parseFloat(e):e;return isNaN(t)?"":new Intl.NumberFormat("ko-KR").format(t/1e6)},y=e=>{if(!e)return"";let t=0;for(let r=0;r<e.length;r++)if(" "===e[r])t++;else break;let r=e.trimStart(),d="";for(let e=0;e<t;e++)d+="\xa0";return(0,l.jsxs)(l.Fragment,{children:[d,r]})},k=async()=>{if(p(null),!n)return void a("먼저 엑셀 파일을 선택해주세요.");c||p("시트명을 입력하지 않으면 자동으로 모든 시트가 변환됩니다."),t(!0),a(null);let e=new FormData;e.append("file",n);let r="https://railwaydsdgen-production.up.railway.app/dsdgen/upload";c&&(r+="?sheet_name=".concat(c));try{let t=await fetch(r,{method:"POST",body:e});if(!t.ok)throw Error("API 요청 실패: ".concat(t.status));let l=await t.json();if(c)if(l.sheets&&l.sheets[c]&&l.sheets[c].length>0){let e=l.sheets[c];x(e),e.length>0&&h(Object.keys(e[0]))}else throw Error("시트 데이터가 없습니다.");else{let e=Object.keys(l.sheets);if(e.length>0){let t=e[0],r=l.sheets[t];x(r),r.length>0&&h(Object.keys(r[0]))}else throw Error("시트 데이터가 없습니다.")}}catch(e){console.error("DSD 업로드 오류:",e),a(e instanceof Error?e.message:"DSD 업로드 중 오류가 발생했습니다.")}finally{t(!1)}};return(0,l.jsx)("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md dark:shadow-gray-900",children:(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-6 text-gray-800 dark:text-white",children:"DSD 데이터 생성"}),r&&(0,l.jsx)("div",{className:"bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4",children:(0,l.jsx)("p",{children:r})}),m&&(0,l.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/30 border-l-4 border-blue-400 dark:border-blue-700 p-4 mb-4",children:(0,l.jsx)("p",{className:"text-blue-700 dark:text-blue-300",children:m})}),e&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500"})}),(0,l.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"엑셀 파일 업로드"}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("label",{className:"flex cursor-pointer items-center justify-center px-4 py-2 bg-indigo-600 dark:bg-indigo-700 text-white font-medium rounded-md hover:bg-indigo-700 dark:hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-colors",children:[(0,l.jsx)("span",{children:"파일 선택"}),(0,l.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&(s(r),i(r.name))},className:"hidden"})]}),(0,l.jsx)("span",{className:"text-gray-600 dark:text-gray-300 text-sm",children:o||"선택된 파일 없음"})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"시트 이름"}),(0,l.jsx)("input",{type:"text",value:c,onChange:e=>g(e.target.value),placeholder:"예: D210000",className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 dark:bg-gray-700 dark:text-gray-200"})]}),(0,l.jsx)("button",{onClick:k,disabled:e,className:"px-4 py-2 bg-indigo-600 dark:bg-indigo-700 text-white font-medium rounded-md hover:bg-indigo-700 dark:hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-colors disabled:opacity-50",children:"업로드 및 변환"})]}),u.length>0&&b.length>0?(0,l.jsx)("div",{className:"overflow-x-auto mt-6",children:((e,t)=>{if(!e.length||!t.length)return(0,l.jsx)(l.Fragment,{});let r=e.filter((e,t)=>2!==t);return(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{textAlign:"right",marginBottom:"5px"},children:(0,l.jsx)("span",{style:{fontFamily:"굴림",fontSize:"10pt",color:"buttontext"},children:"(단위: 백만원)"})}),(0,l.jsx)("div",{style:{marginBottom:"10px"},children:(0,l.jsx)("button",{onClick:()=>{let e=document.getElementById("dsd-table");if(e)try{var t,r,l;let d=document.createRange();d.selectNode(e),null==(t=window.getSelection())||t.removeAllRanges(),null==(r=window.getSelection())||r.addRange(d);let a=document.execCommand("copy");null==(l=window.getSelection())||l.removeAllRanges(),a?alert("표가 복사되었습니다!"):alert("복사 실패")}catch(e){alert("복사 실패")}},style:{padding:"8px 16px",backgroundColor:"#4f46e5",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontFamily:"굴림"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#4338ca",onMouseOut:e=>e.currentTarget.style.backgroundColor="#4f46e5",children:"표 전체 복사"})}),(0,l.jsxs)("table",{id:"dsd-table",style:{borderCollapse:"collapse",width:"100%"},children:[(0,l.jsx)("thead",{children:(0,l.jsx)("tr",{children:t.map((e,t)=>(0,l.jsx)("td",{className:"default",valign:"middle",align:0===t?"left":"right",style:{paddingBottom:"5px",paddingTop:"5px",paddingLeft:0===t?"20px":"5px",paddingRight:"5px",border:"1px solid #999"},children:(0,l.jsx)("span",{style:{fontFamily:"굴림",fontSize:"11pt",color:"buttontext"},children:e})},t))})}),(0,l.jsx)("tbody",{children:r.map((e,r)=>(0,l.jsx)("tr",{children:t.map((t,d)=>(0,l.jsx)("td",{className:"default",valign:"middle",align:0===d?"left":"right",style:{paddingBottom:"5px",paddingTop:"5px",paddingLeft:0===d?"20px":"5px",paddingRight:"5px",border:"1px solid #999"},children:(0,l.jsx)("span",{style:{fontFamily:"굴림",fontSize:"11pt",color:"buttontext"},children:0===d?y(e[t]):f(e[t])})},"".concat(r,"-").concat(d)))},r))})]})]})})(u,b)}):(0,l.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/30 border-l-4 border-blue-400 dark:border-blue-700 p-4",children:(0,l.jsx)("p",{className:"text-blue-700 dark:text-blue-300",children:"엑셀 파일과 시트 이름을 입력한 후 업로드해주세요."})})]})})}},62258:(e,t,r)=>{Promise.resolve().then(r.bind(r,5973))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(62258)),_N_E=e.O()}]);